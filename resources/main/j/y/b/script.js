/*!
 * FED Process
 * Copyright 2011. All rights reserved.
 */
var Gv={env:"pro",page:null,hidden:"hidden",ge:new Events(),url:{ext:"/j/y/b/ext"}};String.implement({explode:function(b,a){var a=(a||""),c=this+b,g=new RegExp(a+b,"g"),d,f=[],h=false,e;while(!h){d=c.search(g);if(d=="-1"){h=true}else{if(d!=0){e=c.substring(0,d);f.push(e)}if(c.length>1){c=c.slice(d+1)}else{h=true}}}return f}});var Core=new Class();Core.extend({id_to_page:function(a){return"Page"+a.trim().capitalize()}});var Page=new Class();var Site=new Class({initialize:function(){this.pre();var bdy=document.id(document.body),id=bdy.get("id"),page,page_var;eval("page_var = typeOf("+Core.id_to_page(id)+")");if(page_var&&page_var=="class"){eval("page = new "+Core.id_to_page(id)+"()");Gv.page=page}this.post()},pre:function(){},post:function(){}});var Card=new Class({Implements:[Events,Options],options:{cls:"w_card",is_autorun:true,is_preloaded:true,first_autorun_duration:5000,autorun_duration:5500,transition_duration:200},initialize:function(a,b){this.setOptions(b);
if(a){this._element=a;this.build()}},build:function(){var b=this.options,a="."+b.cls,c=document.id(this);this.is_first=true;this.is_animating=false;this.pagination=null;this._btnprevious=c.getElement(a+"_btnprevious");this._btnnext=c.getElement(a+"_btnnext");this._pagination=c.getElement(a+"_pagination");this._stage=c.getElement(a+"_stage");this._items=c.getElements(a+"_item");if(this._items.length>1){this.pagination=new Card.Pagination(this._pagination,this)}this.stage=new Card.Stage(this._stage,this._items,this);this._btnprevious.addEvent("click",function(){this.is_clicked=true;this.clear_periodical().set_previous_image()}.bind(this));this._btnnext.addEvent("click",function(){this.is_clicked=true;this.clear_periodical().set_next_image()}.bind(this));this.set_image(0);this.periodical=null;if(b.is_autorun){this.set_direction("next");(function(){if(this.is_clicked==null||this.is_clicked==false){this.set_next_image();this.periodical=this.clear_periodical().set_next_image.periodical(this.options.autorun_duration,this)
}}).bind(this).delay(b.first_autorun_duration)}},clear_periodical:function(){if(this.options.is_autorun&&this.periodical){this.options.is_autorun=false;clearInterval(this.periodical)}return this},get_direction:function(){return this.direction},set_animating:function(a){this.is_animating=a},set_direction:function(a){this.direction=a;return this},set_image:function(a){if(!this.is_animating){this.stage.set_image_by_index(a);this.pagination.set_current_page_index(a)}},set_next_image:function(){this.set_direction("next");this.set_image(this.pagination.retrieve_next())},set_previous_image:function(){this.set_direction("previous");this.set_image(this.pagination.retrieve_previous())},toElement:function(){return this._element}});Card.Pagination=new Class({Implements:[Events,Options],options:{cls:"w_card_pagination"},initialize:function(a,c,b){this.setOptions(b);if(a){this._element=a;this.card=c;this.build()}},build:function(){var b=this.options,a=b.cls,c=this._element;this.items=[];this.current_page_index=0;
this.card._items.length.times(function(d){var e=new Element("a",{href:"#",html:"&#9632;",events:{click:function(g){g.stop();var f=(this.get_current_page_index()<d)?"next":"previous";this.card.is_clicked=true;this.card.clear_periodical().set_direction(f).set_image(d)}.bind(this)}}).inject(c);this.items.push(e)}.bind(this))},get_current_page_index:function(){return this.current_page_index},retrieve_next:function(){var a=this.items.length;if(this.current_page_index==a-1){return 0}return this.current_page_index+1},retrieve_previous:function(){var a=this.items.length;if(this.current_page_index==0){return a-1}return this.current_page_index-1},set_current_page_index:function(a){this.items[this.current_page_index].removeClass("selected");this.current_page_index=a;this.items[a].addClass("selected")},toElement:function(){return this._element}});Card.Stage=new Class({Implements:[Events,Options],options:{cls:"w_card_stage"},initialize:function(a,d,c,b){this.setOptions(b);if(a){this._element=a;this._items=d;
this.card=c;this.build()}},build:function(){var b=this.options,a="."+b.cls,c=document.id(this);this.active_item=null;this.items=[];this.times_accessed=0;this._canvas=c.getElement(a+"_canvas");this._items.each(function(f,e){var d={};if(e==0){d={preloads:false}}this.items.push(new Card.Item(f,this,this.card,d))}.bind(this));if(this.card.options.is_preloaded){this.preload()}},manage_z:function(a,b){},preload:function(){var a=[];this.items.each(function(b){a.push(b.get_src())}.bind(this));Asset.images(a,{onProgress:function(d,b){this.items[b].is_loaded=true;this.items[b].set_image()}.bind(this),onComplete:function(){this.fireEvent("on_preload")}.bind(this)})},get_container:function(){return this._canvas},set_image:function(a){if(this.active_item){this.active_item.close()}this.active_item=a;a.open();a.set_image();this.times_accessed++},set_image_by_index:function(a){this.set_image(this.items[a])},toElement:function(){return this._element}});Card.Item=new Class({Implements:[Events,Options],options:{cls:"w_card_item",preloads:true},initialize:function(a,d,c,b){this.setOptions(b);
if(a){this._element=a;this.stage=d;this.card=c;this.build()}},build:function(){var d=this.options,a=d.cls,b="."+a,e=document.id(this);this.has_image=false;this.src=e.getProperty("data-image");this.url=e.getProperty("data-url")||false;if(this.url){this.enable_card_click()}this.is_loaded=false;this.width=e.getSize().x;var c=this.card.options.transition_duration||0;this.fx=new Fx.Morph(e,{link:"cancel",duration:c})},enable_card_click:function(){document.id(this).set({styles:{cursor:"pointer"},events:{click:this.go_to_url.bind(this)}})},go_to_url:function(){location.href=this.url},close:function(){var a=this.card.get_direction();var b=[0,-this.width];switch(a){case"previous":b=[0,this.width];break;case"next":default:}this.card.set_animating(true);this.fx.start({opacity:0}).chain(function(){this.card.set_animating(false)}.bind(this))},preload:function(){if(this.options.preloads){Asset.image(this.src)}},load_image:function(){(function(){Asset.image(this.src,{onLoad:function(){console.log("Goes here");
this.is_loaded=true;this.set_image()}.bind(this)})}).delay(300,this)},open:function(){var a=this.card.get_direction(),b=document.id(this);b.removeClass("inactive").addClass("active");this._element.setStyles({visibility:"visible",opacity:0.1});this.card.set_animating(true);this.fx.start({opacity:1}).chain(function(){b.addClass("post");this.card.set_animating(false)}.bind(this))},get_src:function(){return this.src},set_image:function(){if(!this.is_loaded&&!this.card.options.is_preloaded){this.load_image()}else{if(!this.has_image){this.has_image=true;var a=this.src.trim();document.id(this).setStyle("background-image","url("+a+")")}}},toElement:function(){return this._element}});PageHom=new Class({Extends:Page,initialize:function(){alert("inside homepage")}});var site;window.addEvent("domready",function(){site=new Site()});